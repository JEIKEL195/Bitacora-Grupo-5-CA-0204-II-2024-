# Bitácora 2 

## Parte de Planificación 

### Ordenamiento de la Literatura 

**Tabla de Organización y Literatura**




\begin{longtable}{| p{2.5cm} | p{2cm} | p{2.5cm} | p{3cm} | p{0.8cm} | p{2.5cm} |}
\hline
\textbf{Tipo} & \textbf{Tema General} & \textbf{Tema Específico} & \textbf{Título} & \textbf{Año} & \textbf{Autor(es)} \\
\hline
\fontsize{8pt}{10pt}
Metodológica & Correlación y Análisis de datos & Análisis del perfil de los prestatarios & La evaluación del riesgo de crédito en las instituciones de microfinanzas: estado del arte & 2017 & María Seijas, Milagro Vivel, Rubén Lado, Sara Fernández \\
\hline
Metodológica & Correlación y Análisis de datos & Relevancia del scoring de crédito & Modelos para el otorgamiento y seguimiento en la gestión del riesgo crediticio & 2018 & Millan Solarte, Julio Cesar, Edinson Caicedo \\
\hline
Metodológica & Correlación y Análisis de datos & Relación variables cuantitativas y cualitativas en el incumplimiento de pago & Variables determinantes de la probabilidad de incumplimiento de un microcrédito & 2011 & María Calixto, Luis Casaverde \\
\hline
Metodológica & Correlación y Análisis de datos & Clasificación de perfiles basándose en variables cualitativas & Credit Scoring en Costa Rica y la probabilidad de clasificación de créditos personales & 2013 & Patricia Hernández, José Montoya, Allan Villareal \\
\hline
\end{longtable}

\normalsize
\newpage

## Enlaces de la Literatura

**Título:** *La valoración del riesgo financiero*.

**Resumen:** El riesgo financiero es uno de los tipos de riesgo más importantes, por eso es de suma importancia entender su significado y qué herramientas se pueden utilizar para su debida gestión. En este caso se enfocan en tres métodos distintos: la desviación estándar, la beta del mercado y el valor en riesgo; así como comprender la rentabilidad ajustada con el ratio de Sharpe. Al utilizarlos en estrategias de cobertura de riesgo financiero se logra una reducción o mitigación del mismo en diferentes intrumentos financieros como las carteras de inversión.

**Contraste:** Este trabajo, a comparación del artículo de Solarte J. y Caicedo E. titulado Modelos para otorgamiento y seguimiento en la gestión del riesgo de crédito, logra explicar de manera más amigable y general los conceptos del riesgo financiero, lo que hace que el artículo de Chicu sea más comprensible para todas las personas. Sin embargo, esta falta de rigurosidad puede generar fallas en los procesos más complejos del tema de investigación, ya que el mismo artículo de Solarte y Caicedo utiliza fórmulas y métodos más complejos que si bien no son tan fáciles de entender, logran una mejor recopilación de resultados.

**Comentario Propio:** Si bien nos parece importante que una explicación sea comprensible para la mayor cantidad de personas, no tener la suficiente precisión en un tema tan complicado como lo es el riesgo financiero puede causar ignorancia en los conceptos avanzados, como por ejemplo los métodos paramétricos y no paramétricos y su metodología. Sin embargo, sentimos que esta investigación nos ayudó con la afinidad a la hora de seleccionar las palabras adecuadas en el desarrollo de nuestra investigación.

**Título:** *La evaluación del riesgo de crédito en las instituciones de microfinanzas: estado del arte*.

**Resumen:** El análisis de los modelos de credit scoring muestra que estos pueden ser utilizados en diversas dimensiones, aunque hay una preferencia por predecir el riesgo de retrasos costosos en los microcréditos los cuales están bajo control de las instituciones financieras para mitigarlos. La literatura teórica destaca la importancia de la información estadística cualitativa en estos modelos, además de incluir variables relacionadas con el prestatario, su negocio y el préstamo. Existe una preferencia por las téncicas paramétricas como por ejemplo la regresión logística. Aún así, en los últimos años se registra un aumento en el uso de técnicas no paramétricas que logran un mayor poder predictivo en la detección de incumplimientos de microcréditos. Con esto, las instituciones están incorporando estas herramientas para convertirlas en una práctica estándar, como en las instituciones bancarias; las cuales mejoran la consistencia, transparencia, control de calidad y optimización de los procesos.

**Contraste:** Éste trabajo, a diferencia del artículo de Chicu D. titulado La valoración del riesgo financiero, logra realizar no sólo un análisis del credit scoring por medio de teoría estadística, sino que también logra plantear un análisis macroeconómico y toma en cuenta las repercusiones que las fallas en los procesos de gestion de riesgos podría generar en el sistema financiero. Sin embargo, no es tan específico en la parte matemática a la hora de estimar probabilidades de que algo pase. 

**Comentario Propio:** Para nosotros es importante entender también la teoría desde la perspectiva economista ya que nos ayuda a entender a qué nos enfrentamos y cómo podemos aplicar diferentes metodologías de investigación.

**Título:** *Modelos para otorgamiento y seguimiento en la gestión del riesgo de crédito.*

**Resumen:** El credit scoring es un método estadístico para estimar la probabilidad de inclumpimiento de un prestatario, usando su información histórica y estadística para obtener un indicador que permita distinguir la calidad de un deudor. Los modelos de scoring son muy importantes para los procesos de gestión del crédito, los cuales buscan explicar la composición y operatividad de estos modelos utilizando grandes bases de datos. La información que resulta de estos modelos permite el análisis de la toma de decisión de si se otorga ó no un crédito a una persona. Por medio de cuatro modelos distintos se logra un procedimiento multicapa para obtener información precisa para calificar a un cliente como bueno o malo para la empresa financiera. 

**Contraste:** Este trabajo logra ser más específico que los demás en cuanto a los métodos de gestión de riesgo se refiere. Además coincide con varios de los artículos recopilados respecto a la utilización del método de regresión logística como herramienta de calificación de crédito.

**Comentario Propio:** Consideramos que este artículo es el más completo en cuanto a materia matemática se refiere, ya que logra explicar los métodos de manera clara y además los muestra con las gráficas y resultados obtenidos. De hecho, es de gran ayuda que las variables a trabajar sean similares a las que la investigación utiliza.

**Título:** *Variables determinantes de la probabilidad de incumplimiento de un microcrédito en una entidad microfinanciera del Perú, una aproximación bajo el modelo de regresión logística binaria.*

**Resumen:** Después de realizar una estimación probabilística del incumplimiento de un microcrédito por medio de la aproximación de una función logística binaria, se determina que son las variables cualitativas como el estado civil, edad y tipo de vivienda junto con las variables de plazo, número de créditos con la entidad y el saldo deudor; las que generan un modelo correctamente ajustado bajo el modelo de regresión logística.  La cual logra una capacidad predictiva aceptable medida por la curva ROC.

**Contraste:** Este trabajo, a diferencia de “La evaluación del riesgo de crédito en las instituciones de microfinanzas: estado del arte”, determina las variables necesarias para un estudio de microfinanzas. Sin embargo, coinciden en todo lo referente a las ventajas y deventajas del uso de la calificación crediticia, aunque si cabe mencionar que esta investigación tambien logra hacer conclusiones de los inversores y reguladores como parte de los responsables de la ineficiencia que ha dado el uso excesivo de ésta calificación.

**Comentario Propio:** Fue de mucha ayuda entender la noción de qué variables utilizar y porqué son importantes para un estudio de calificación de crédito.

**Título:** *Calificación de riesgo: definición e influencia en la última década*.

**Resumen:** Las agencias de calificación crediticia han crecido en las últimas décadas por su capacidad para reducir las asimetrías de información en los mercados, facilitando la liquidez y aumentando los participantes. Sin embargo, no han cumplido con los efectos positivos esperados en la última década, se han expuesto fallas en su funcionamiento, como su papel en la burbuja de deuda y la crisis económica, lo que ha generado inestabilidad y ralentizado la recuperación. La importancia que los inversores le dieron a las calificaciones crediticias para la toma de desiciones fue desmedida al no tomar en cuenta el nivel de riesgo, lo cual se relaciona a las causas de las últimas crisis financieras e hipotecarias.

**Contraste:** En comparación de la investigación titulada “La evaluación del riesgo de crédito en las instituciones de microfinanzas: estado del arte”, ambos logran concluir cosas muy similares en cuanto a la importancia del credit score, sus ventajas y desventajas. Sin embargo, logra aportar más en cuanto a las ineficiencias que ha tenido sobrevalorarlo y los momentos en los que ha generado una crisis. 

**Comentario Propio:** Este trabajo, de igual forma, es de suma importancia para entender la manera en que se realizan calificaciones crediticias y de qué formas analizarlas. Para así utilizarlas en nuestros estudios estadísticos y entender qué otras variables ó conceptos tomar en cuenta para los futuros resultados a obtener.

**Título:** Conceptualización del riesgo de los mercados financieros.

**Resumen:** El riesgo está inmerso en todas las actividades humanas y es entendido como la probabilidad de ocurrencia de un evento que podría inducir un perjuicio. Cuando se habla de riesgo financiero, se habla de una eventual pérdida de dinero que signifique una afectación al sistema financiero ó a alguna institución que sea parte del mismo. Este trabajo es una recopilación algunos de los riesgos en los mercados financieros y presenta algunos métodos válidos para su valoración.

**Contraste:** Esta investigación, a diferencia de las demás investigaciones, logra tener un glosario completo de definiciones relacionadas al riesgo financiero, sin embargo no va más allá de ser sólamente un artículo de definiciones. Por lo que en materia teórica no tiene nada que aportar. 

**Comentario Propio:** Gracias a estas definiciones, hemos logrado definir mejor qué queremos estudiar de manera más específica y cómo utilizar ciertos conceptos de mejor manera.



## Análisis Estadístico

Como base para realizar este análisis estadístico, nos estamos guíando con la guía del curso de Herramientas de Ciencias de Datos, el cual adjuntamos el link a dicha guía https://maikolsolis.com/libros/hpcd/ y también estamos utilizando el libro escrito por Wickham, el cual también adjuntamos el link https://r4ds.hadley.nz/. 

A modo de introducción, el análisis estadístico consiste en un conjunto de herramientas o técnias que se utilizan para la recolección, el análisis e interpretación de datos. Para este trabajo es imprescindible contar con este set de herramientas. 

### Análisis Descriptivo 
La base de datos ya se encuentra en formato en tidy, recordemos que el formato tidy fue popularizado por el autor Hadley Wickham, donde indican que cada variable debe tener su propia columna y cada observación su propia fila. Nuestra base de datos cumple con estar en formato tidy. 


Vamos a llamar a nuestra base de datos, la cual vamos a utilizar durante el trabajo.

```{r}
library(readr)
base_financial_risk_assessment <- read_delim("base-financial-risk-assessment.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(base_financial_risk_assessment)
```

```{r}
head(base_financial_risk_assessment)
```

Antes de aplicar cualquier gráfico o análisis de datos a nuestra base de datos, es importante eliminar las variables que no aportan al estudio, por ello, vamos a eliminar los valores NA que vengan en nuestra base de datos.

```{r}
Base_limpia <- na.omit(base_financial_risk_assessment)
head(Base_limpia)
```

Con la base de datos limpia, ya podemos hacer un análisis estadístico, para ello vamos a calcular estadísticos base, como lo son la media, la varianza, el mínimo, el máximo de las variable numéricas, además de calcular la moda, para las variables que no sean numéricas. 

```{r, echo= FALSE}
library(dplyr)
resultado <- Base_limpia %>% 
  summarise(
    
    # calculamos los estadísticos de interés para la variable edad/Age
    media_edad = mean(Age),
    varianza_edad = var(Age),
    min_edad = min(Age),
    max_edad = max(Age),
    
    # Calculamos los estadísticos de interés para la variable ingreso/Income
    media_ingresos = mean(Income),
    varianza_ingresos = var(Income),
    min_ingresos = min(Income),
    max_ingresos = max(Income),
    
    # Calculamos los estadísticos de interés para la variable record_crediticio/ Credit Score
    media_record_crediticio = mean(`Credit Score`),
    varianza_record_crediticio = var(`Credit Score`),
    min_record_crediticio = min(`Credit Score`),
    max_record_crediticio = max(`Credit Score`),
    
    # Calculamos los estadísticos de interés para la variable monto del préstamo/ Loan Amount
    media_monto_prestamo = mean(`Loan Amount`),
    varianza_monto_prestamo = var(`Loan Amount`),
    min_monto_prestamo = min(`Loan Amount`),
    max_monto_prestamo = max(`Loan Amount`),
    
    # Calculamos los estadísticos de interés para variable anyos_trabajo / Years at current job
    media_anyos_trabajo = mean(`Years at Current Job`),
    varianza_anyos_trabajo = var(`Years at Current Job`),
    min_anyos_trabajo = min(`Years at Current Job`),
    max_anyos_trabajo = max(`Years at Current Job`),
  )
```

Estos son los datos resumidos de la variable edad.

```{r}
resultado$media_edad
resultado$min_edad
resultado$max_edad
```

Estos son los datos resumidos de la variable Ingresos 

```{r}
resultado$media_ingresos
resultado$varianza_ingresos
resultado$min_ingresos
resultado$max_ingresos
```

Estos son los datos resumidos de la variable Monto del Préstamo

```{r}
resultado$media_monto_prestamo
resultado$varianza_monto_prestamo
resultado$min_monto_prestamo
resultado$max_monto_prestamo
```


Ahora vamos analizar cómo es la distribución que siguen los géneros de nuestra base de datos, esto es solamente por sondear cómo es nuestra población. Al ser una variable categórica, lo recomendado es realizar un gráfico de barras.

```{r}
library(ggplot2)
# Gráfico con las distribuciones del género
ggplot(Base_limpia, aes(x = Gender, fill = Gender)) +
  geom_bar() +
  scale_fill_manual(values = c("Male" = "blue", "Female" = "pink", "Non-binary" = "gray")) +
  labs(x = "Distribución de Géneros", y = "Frecuencia") + theme_minimal()

```

Por otro lado, la variable "Income", es una variable continua, por lo que lo recomendado para visualizar la distribución de estos datos de una manera rápida es a través de los histogramas, por lo que adjuntamos el gráfico correspondiente:

```{r}
library(ggplot2)
ggplot(Base_limpia, aes(x = Income)) + 
  geom_histogram(binwidth = 10000, fill = "lightblue", color = "black") + 
  labs(x = "Ingreso", y = "Frecuencia", title = "Distribución de Ingresos") +
 theme_minimal()
```

Además decidimos realizar un facet en esta misma variable con respecto a la variable "Education Level", con el fin de visualizar la distribución en cada categoría, esto porque queremos descartar o validar que de alguna forma el nivel educativo tiene relación con nuestra variable objetivo, la cual es la calificación de riesgo.


```{r}
library(ggplot2)
ggplot(Base_limpia, aes(x = Income)) + 
  geom_histogram(binwidth = 10000, fill = "lightblue", color = "black") + 
  labs(x = "Ingreso", y = "Frecuencia", title = "Distribución de Ingresos") + theme_minimal() +
  facet_wrap(~ `Education Level`)  # Facet por nivel educativo
```

Adjuntamos un gráfico más de los ingresos, pero esta vez por género, con la misma curiosidad de observar cómo es la distribución de estos dada la mencionada variable.


```{r}
library(ggplot2)
ggplot(Base_limpia, aes(x = Income)) + 
  geom_histogram(binwidth = 10000, fill = "lightblue", color = "black") + 
  labs(x = "Ingreso", y = "Frecuencia", title = "Distribución de Ingresos") + theme_minimal() +
  facet_wrap(~ Gender)  # Facet Género
```


Otras variables a tener en cuenta aparte de las anteriores mencionadas con respecto al riesgo de crédito, son el monto del préstamos y el propósito del préstamo. Vamos analizar primero el Monto del préstamo, nos interesa ver qué distribución en general tiene.

```{r}
library(ggplot2)

ggplot(Base_limpia, aes(x = `Loan Amount`, fill = Gender)) +  
  geom_histogram(binwidth = 5000, color = "black", position = "identity") +  
  scale_fill_manual(values = c("Male" = "darkblue", "Female" = "purple", "Non-binary" = "green")) +  
  facet_wrap(~ Gender) +  
  labs(x = "Monto del Préstamo", y = "Frecuencia", title = "Distribución del Monto de Préstamo por Género") + 
  theme_minimal() +
  theme(axis.text.y = element_text(size = 10), # Ajustamos el tamaño del texto
        axis.text.x = element_text(angle = 45, hjust = 1))  #Rotamos el texto


```

Haremos lo mismo, pero esta vez vamos a ver cómo se comportan los salarios cuando cambiamos la variable y utilizamos por ejemplo el grado académico.

```{r}
library(ggplot2)

ggplot(Base_limpia, aes(x = `Loan Amount`, fill = `Education Level`)) +  
  geom_histogram(binwidth = 5000, color = "black", position = "identity") +  
  scale_fill_manual(values = c("Bachelor's" = "darkblue", "High School" = "purple", "Master's" = "green", "PhD" = "red")) +  
  facet_wrap(~ `Education Level`) +  
  labs(x = "Monto del Préstamo", y = "Frecuencia", title = "Distribución del Monto de Préstamo por Nivel Educativo") + 
  theme_minimal() +
  theme(axis.text.y = element_text(size = 10), # Ajustamos el tamaño del texto
        axis.text.x = element_text(angle = 45, hjust = 1))  #Rotamos el texto
```
Por otro lado, ahora queremos ver el gráfico de la variable propósito del préstamo en relación con el grado académico, al ser ambas variables categóricas, lo recomendado es utilizar una geometría que se adapte a esto, Sin embargo, al ser medidas que están muy cercanas, casi no se aprecia la diferencia, por lo que se decide adaptarlo a un gráfico de barras y apreciar mejor la diferencias de manera visual, también recurrimos al uso de colores, para identificar las variables. 

```{r}
library(ggplot2)
library(dplyr)

# Contar las combinaciones de Education Level y Loan Purpose
Base_count <- Base_limpia %>%
  group_by(`Education Level`, `Loan Purpose`) %>%
  summarise(Count = n(), .groups = 'drop')

# Gráfico de barras para visualizar el conteo
ggplot(Base_count, aes(x = `Education Level`, y = Count, fill = `Loan Purpose`)) +
  geom_bar(stat = "identity", position = "dodge") +  # Usa barras para mostrar el conteo
  labs(x = "Nivel Educativo", y = "Conteo", title = "Conteo del Propósito del Préstamo por Nivel Educativo") +
  scale_fill_manual(values = c("Business" = "blue", "Personal" = "purple", "Home" = "green", "Auto" = "yellow")) +
  theme_minimal()

```

Para terminar esta sección, vamos a graficar con la variable objetivo de interés, la cual es la Calificación de riesgo, para ello, lo vamos a comparar a través de diversos gráficos con las variables de nivel educativo, ingresos, monto del préstamo, edad y género. Es importante mencionar, que las variables en conjunto afectan a esta calificación, al menos así es de manera teórica. En este apartado nos vamos a centrar en estos gráficos, en secciones posteriores nos ecargaremos de hacer la conexión entre la teoría, nuestras hipótesis y los datos obtenidos. 

Para comenzar, nos interesa observar cómo se comporta la variable de Calificación de Riesgo, con respecto a la edad:

```{r}
library(ggplot2)
ggplot(Base_limpia, aes(x = Age, fill = `Risk Rating`)) +
  geom_bar() +  
  labs(x = "Edad", y = "Conteo", title = "Distribución de Calificación de Riesgo por Edad") + 
  theme_minimal() +  
  scale_fill_brewer(palette = "Set1")  
```


Por otro lado, vamos a ver cómo se comporta la distribución de la calificación de riesgo, haciendo un facet con la categoría Nivel Educativo. Al ser dos variables categóricas las que estamos comparando, lo recomendado es utilizar un gráfico de barras. 


```{r}
library(ggplot2)

ggplot(Base_limpia, aes(x = `Risk Rating`, fill = `Education Level`)) +  
  geom_bar(color = "black", position = "identity") +  
  scale_fill_manual(values = c("Bachelor's" = "darkblue", "High School" = "purple", "Master's" = "green", "PhD" = "red")) +  
  facet_wrap(~ `Education Level`) +  
  labs(x = "Calificación de Riesgo", y = "Frecuencia", title = "Distribución de la Calificación de Riesgo por Nivel Educativo") + 
  theme_minimal() +
  theme(axis.text.y = element_text(size = 10), # Ajustamos el tamaño del texto
        axis.text.x = element_text(angle = 45, hjust = 1))  # Rotamos el texto


```


A su vez, nos interesa observar cómo se ve el gráifco de la variable calificación de riesgo con la variable contra la variable ingreso. Para este gráfico, vamos a utilizar el recomendado en las notas del profesor Maikol Solís, el cual indica que usar diagramas de cajas es útil para comparar las distribuciones. 

```{r}
library(ggplot2)

ggplot(Base_limpia, aes(x = `Risk Rating`, y = Income, fill = `Risk Rating`)) +  
  geom_boxplot(color = "black") +  
  scale_fill_manual(values = c("Low" = "green", "Medium" = "yellow", "High" = "red", "Very High" = "purple")) +  
  labs(x = "Calificación de Riesgo", y = "Ingreso", title = "Comparación de la Calificación de Riesgo con el Ingreso") + 
  theme_minimal() +
  theme(axis.text.y = element_text(size = 10), # Ajustamos el tamaño del texto
        axis.text.x = element_text(angle = 45, hjust = 1))  # Rotamos el texto

```

Otra de las variables de interés, es la calificación de riesgo contra el propósito del préstamo. 

```{r}
library(ggplot2)

ggplot(Base_limpia, aes(x = `Loan Purpose`, fill = `Risk Rating`)) +  
  geom_bar(position = "fill", color = "black") +  
  scale_fill_manual(values = c("Low" = "green", "Medium" = "yellow", "High" = "red", "Very High" = "purple")) +  
  labs(x = "Propósito del Préstamo", y = "Proporción", title = "Distribución de la Calificación de Riesgo según el Propósito del Préstamo") + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotamos el texto para mejorar la legibilidad

```





